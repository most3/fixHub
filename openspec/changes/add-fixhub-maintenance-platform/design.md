# Design: 设备报修与维护平台核心能力

## 1. 概览
平台包含三类角色：报修用户（REPORTER）、维修工（TECHNICIAN）、管理员（ADMIN）。报修流程由报修用户发起，管理员派单，维修工处理并回填结果，报修用户确认并评价。管理员维护设备与查看统计看板。

## 2. 角色与权限
- REPORTER：创建报修单、查看自己的报修单、确认与评价。
- TECHNICIAN：查看分配给自己的工单、接单与处理、填写处理结果。
- ADMIN：设备维护、派单、查看所有工单与统计。
- 管理员可生成随机维修工账号并下发，减少身份滥用。
- 维修工首次登录需补全资料（如手机号、姓名等）后才能接单。

## 3. 报修流程与状态机
状态机：
- PENDING（待受理）：报修用户提交后初始状态。
- IN_PROGRESS（处理中）：管理员派单并由维修工接单/处理中。
- WAITING_REVIEW（待评价）：维修工提交处理结果后进入待评价。
- COMPLETED（已完成）：报修用户确认并评价后完成。

状态变迁：
- REPORTER 创建 → PENDING
- ADMIN 派单 → IN_PROGRESS
- TECHNICIAN 提交处理结果 → WAITING_REVIEW
- REPORTER 确认/评价 → COMPLETED

## 4. 数据模型（概念层）
- User：账号基础信息（用户名、角色、密码哈希、创建时间）
- TechnicianProfile：维修工补全信息（电话、姓名、备注、完成标记）
- Device：设备信息（名称、型号、位置、描述、采购日期等）
- RepairOrder：报修单（设备信息、故障描述、状态、关联用户/维修工、时间戳）
- RepairComment：评价（评分、评价内容、时间）
- Attachment（可选）：报修单图片附件（URL/对象存储 Key）

## 5. API 契约与文档
- 所有接口使用统一响应结构（code/message/data/requestId）。
- OpenAPI 文档必须包含中文接口描述与字段说明。
- Swagger UI 提供中文提示页面与入口说明。

## 6. 可观测性与审计
- 关键动作记录审计日志（派单、完成、评价）。
- 统计指标：维修量、平均响应时间、满意度。

## 7. 安全与输入校验
- 角色访问控制与权限校验。
- 报修内容、评价内容进行长度与格式校验。
- 图片上传遵循类型与大小限制（若启用）。
